import { Component, OnInit, Input } from '@angular/core';
import { AuditVulnerability } from '../../../AuditVulnerability';
import Swal from 'sweetalert2';

import { ModalModifyAuditVulnerability } from './modalModifyAuditVulnerability.service';
import { GestionPreguntas } from '../../gestionPreguntas.component';

@Component({
  selector: 'app-auditVulnerabilityModify',
  templateUrl: './modifyAuditVulnerability.component.html',
  styleUrls: ['./modifyAuditVulnerability.component.css']
})

export class AuditVulnerabilityModifyComponent {

  @Input() auditVulnerability: AuditVulnerability;

  constructor(private modalModifyAuditVulnerability: ModalModifyAuditVulnerability, private gestionPreguntas: GestionPreguntas){}

  modificarAuditVulnerability(){
    this.modalModifyAuditVulnerability.updateAuditVulnerability(this.auditVulnerability).subscribe(
      response => {
        Swal.fire('Vulerability updated', 'Vulnerability correct update', 'success');
        this.cerrarModal();
      }, err => {
        if (err.status == 400 || err.status == 401) {
          Swal.fire('Error updating the vulnerability', 'Try again later', 'error');
        }
      }
    );
  }

  cerrarModal(){
    this.gestionPreguntas.updateQuestionsAndAnswers();
    this.gestionPreguntas.updateQuestionsRelatedToThreat();
    this.modalModifyAuditVulnerability.cerrarModal();
  }
}
