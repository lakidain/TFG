package com.auditorias.springboot.backend.mapper;

import java.util.List;

import org.apache.ibatis.annotations.Insert;
import org.apache.ibatis.annotations.Mapper;
import org.apache.ibatis.annotations.Select;
import org.apache.ibatis.annotations.Update;

import com.auditorias.springboot.backend.model.Audit_Vulnerability;

@Mapper
public interface VulnerabilityMapper {
	
	/* Return a list with all the created vulnerabilities */
	@Select("select * from asi_audit_vulnerabilities")
	List<Audit_Vulnerability> findAllVulnerabilities();
	
	/* Select a Threat searching with a name */
	@Select("select * from asi_audit_vulnerabilities where name_audit_vulnerability=#{name_audit_vulnerability}")
	List<Audit_Vulnerability> findVulnerability(String name_audit_vulnerability);
	
	/*
	 * Create a vulnerability
	 */
	@Insert("insert into asi_audit_vulnerabilities(name_audit_vulnerability) values (#{name_audit_vulnerability})")
	void insertVulnerability(String name_audit_vulnerability);
	
	/*
	 * Associate a Threat with a Vulnerability
	 */
	@Insert("insert into asi_audit_threats_vulnerabilities(id_audit_threat, id_audit_vulnerability) values (#{id_audit_threat},#{id_audit_vulnerability})")
	void associateThreatVulnerability(Long id_audit_threat, Long id_audit_vulnerability);
	
	/*
	 * Updates a vulnerability
	 */
	@Update("update asi_audit_vulnerabilities set name_audit_vulnerability=#{name_audit_vulnerability} where id_audit_vulnerability=#{id_audit_vulnerability}")
	void updateVulnerability(Audit_Vulnerability vulnerability);
}
